## Automatic data curation

从海量杂乱的数据中，自动筛选出高质量的数据集。

**优势：**

无预训练模型。

依靠图片之间的相似度打分，无元数据（如标签），无人工监督。

## Data preprocessing

### 数据源

1. 高质量数据集
2. 海量原始数据源

### 数据去重

### 自监督图像检索

1. 使用特征提取器 ViT 提取特征，用余弦距离作为距离度量
2. 将数据集做 k-means 聚类，将视觉上相似的图片分为一类
3. 对于大型种子数据集的每一张图片，在 12 亿总数据集上找若干张相似图片；对于小型种子数据集中每一张图片，在其具体的类中随机采样若干张图片

种子数据集是指高质量的数据集如 ImageNet

### Discriminative Self-supervised Learning

核心框架：

学生、教师网络：结构完全相同但权重不同的网络。

学生网络是唯一要训练的网络，而教师网络的权重取学生网络历史权重的指数移动平均。

#### 学习目标一：图像级别

将一张图像通过一个 ViT 模型得到一个 class Token

学生和教师网络分别得到的 class Token 经过各自的 DINO 头部（MLP）得到预测的概率 $p_s$ 和 $p_t$   , 定义损失 $L = -\sum p_t\log(p_s)$

#### 学习目标二：图像块级别（iBOT loss）

**输入：**

学生：经过 masked 的图像块

教师：完好无损的图像块

**输出：**

两者提取的特征经过 iBOT 头部分别得到概率分布 $p_{ti}$ 和 $p_{si}$

**损失函数：**

$L_{iBOT} = \sum_i p_{ti}\log p_{si}$

#### SK centering

SK 是一种批量归一化算法。它强制模型在一个批次内输出分布均匀。

#### KoLeo 正则化器

**作用：**鼓励一个批次内的图片的特征尽可能分散开

**原理：**对于一个批次内的图片特征，它会计算和最近邻居的距离，KoLeo会惩罚这个距离更小的情况。

#### 可变分辨率训练

在大部分预训练时间内，采用低分率的图片进行训练；

在预训练的最后一段时间内，采用高分辨率的图片进行训练。
